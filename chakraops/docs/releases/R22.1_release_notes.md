# Release R22.1 — Release engineering + Preflight build gate + repo hygiene

**Date:** 2026-02  
**Goal:** Make release gating real and permanent; document doc structure and out/ policy; ensure frontend build passes and gate is runnable locally.

---

## Scope

- **In scope:** Release gate documented in `RELEASE_CHECKLIST.md`; doc structure standardized (flat `docs/releases/<Release>_release_notes.md`, `out/verification/<Release>/`); out/ allowed contents and “must never commit” list; “How to run the gate locally” steps; Preflight Build Gate verified; one backend test fix so gate passes when market is closed; R22.1 release notes and verification.
- **Out of scope:** New features; changes to decision JSON schema; Phase 23.

---

## API changes

None.

---

## UI changes

None.

---

## Data / persistence

- No changes to decision store or out/ schema. Policy of what is allowed in `out/` and what must never be committed is now documented in the release checklist.

---

## Tests

- **Backend:** `tests/_core/test_one_store_guardrails.py` — `test_recompute_endpoint_writes_to_store_and_universe_sees_it` now calls recompute with `?force=true` so it passes when market is closed (409 otherwise). No new tests added.
- **Frontend:** No new tests; existing suite run as part of gate.

---

## Verification and UAT

- **Commands run:**
  - Backend: `cd chakraops && python -m pytest -v --tb=short` — 535 passed, 1 skipped.
  - Frontend: `cd frontend && npm run test -- --run` — 115 passed, 18 skipped.
  - Build gate: `cd frontend && npm run build` — success.
- **UAT evidence path:** `out/verification/R22.1/notes.md`.
- **Manual steps:** Checklist and template reviewed; doc structure and out/ policy confirmed in checklist.

---

## Known issues

None.

---

## Rollback notes

Revert commits for R22.1; no DB or schema changes. If reverting the test fix, recompute test may again fail when run with market closed.

---

## File list (summary)

- `chakraops/docs/releases/RELEASE_CHECKLIST.md` — Release gate section extended with “How to run the gate locally”, doc structure, out/ allowed contents, must never commit list; R22.1 items marked done.
- `chakraops/docs/releases/R22.1_release_notes.md` — This file.
- `chakraops/tests/_core/test_one_store_guardrails.py` — Recompute test uses `?force=true` so it passes when market is closed.
- `out/verification/R22.1/notes.md` — Commands run and gate results.
