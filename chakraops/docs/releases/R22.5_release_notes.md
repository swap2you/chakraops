# Release R22.5 — Shares evaluation pipeline (recommendation only)

**Date:** 2026-02  
**Goal:** Recommend BUY SHARES candidates with a plan (entry zone, stop, targets, invalidation, hold time); Shares Candidates view and per-symbol Shares Plan; no broker/order placement.

---

## Scope

- **In scope:** Pipeline producing share candidates from existing diagnostics + MTF/support + regime (e.g. regime UP + support → plan). GET `/api/ui/shares-candidates` returns shares_candidates[]. Plan structure: entry_zone, stop, targets, invalidation, hold_time_estimate (sessions + basis_key), confidence_score, why_recommended (keys/codes only). Dashboard "Shares candidates" card; Symbol page "Shares plan" card when eligible. Code→display mappings for why_recommended and hold-time basis.
- **Out of scope:** Broker integration; order placement; persisting free-text in decision store.

---

## API changes

| Method | Path | Description |
|--------|------|-------------|
| GET | `/api/ui/shares-candidates` | Returns **shares_candidates**: array of SharesPlan (symbol, entry_zone, stop, targets, invalidation, hold_time_estimate, confidence_score, why_recommended). |
| GET | `/api/ui/symbol-diagnostics?symbol=` | Response includes **shares_plan** when symbol qualifies (same shape). Request-time only. |

---

## UI changes

- Dashboard: "Shares candidates" card; list of symbols with links to Symbol Diagnostics (plan on symbol page).
- Symbol Diagnostics: "Shares plan" card when data.shares_plan present (entry zone, stop, targets, invalidation, hold-time, confidence, why_recommended via mapping).

---

## Data / persistence

- No new persistence; shares_plan and shares_candidates are request-time computed. Decision artifact remains code-only.

---

## Tests

- Backend: _build_shares_plan_at_request_time, ui_shares_candidates in ui_routes; pipeline uses regime + technicals + exit_plan.
- Frontend: useSharesCandidates; Dashboard Shares candidates card; Symbol page shares_plan section; sharesWhyLabel mapping.

---

## Verification

- **UAT evidence path:** `out/verification/R22.5/notes.md`.

---

## File list (summary)

- `chakraops/app/api/ui_routes.py` — _build_shares_plan_at_request_time, GET /api/ui/shares-candidates, shares_plan in _build_symbol_diagnostics_from_v2_store.
- `frontend/src/api/queries.ts` — sharesCandidatesPath, useSharesCandidates, SharesCandidatesResponse.
- `frontend/src/api/types.ts` — SharesPlan interface.
- `frontend/src/pages/DashboardPage.tsx` — Shares candidates card.
- `frontend/src/pages/SymbolDiagnosticsPage.tsx` — Shares plan card, sharesWhyLabel.
- `out/verification/R22.5/notes.md`.
